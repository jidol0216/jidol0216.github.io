---
title: "📓 2025-12-13 개발 복기 로그 – ESP32 + 레이저 + 서보"
short_title: "Arduino Log"
collection: arduino
type: "Log"
permalink: /arduino/2025-12-13-esp32-devlog/
date: 2025-12-13
excerpt: "12월 13일 작업 복기: 레이저 모듈, 서보 문제와 해결, 코드 수정 및 하드웨어 선택 최종 결론"
read_time: true
share: true
---

## 1️⃣ 시작 목표

- ESP32로
    - 🌟 **레이저 ON/OFF (HTTP 제어)**
    - 🔄 **서보 모터 왕복 동작 (HTTP 제어)**
- 고정 IP + WebServer 기반

---

## 2️⃣ 1차 문제: 레이저가 깜박거림

### 🔍 증상

- 레이저가 계속 깜박임
- ON/OFF도 이상함

### ❌ 원인

- **레이저 모듈 핀 구조 오해**
- HW-493 / KY-008 혼동
- GND 기준 깨짐
- S / VCC 잘못 꽂음

### ✅ 해결

- 실제 모듈이 **KY-008**임을 확인
- **S ↔ VCC를 잘못 꽂고 있었던 걸 수정**
- 레이저는 정상 동작

📌 교훈

> “레이저 모듈은 겉보기 3핀이라도 내부 구조가 다를 수 있다.”

---

## 3️⃣ 2차 문제: 레이저 밝기 이상

### 🔍 증상

- GPIO 제어는 되는데 너무 어두움
- S를 5V에 꽂으면 갑자기 밝아짐

### ❌ 원인

- ESP32는 **3.3V 로직**
- KY-008은 **5V 기준 설계**
- 일부 KY-008은 **S가 사실상 전원 경로처럼 동작**

### ✅ 결론

- 트랜지스터/릴레이 없이는
    
    👉 **밝기(5V) + ON/OFF 제어를 동시에 만족 불가**

---

## 4️⃣ 3차 문제: 서보 모터 갑자기 안 움직임

### 🔍 증상

- 레이저는 정상
- 서보만 무반응
- 소리도 안 남

### ❌ 원인 1 (치명)

```cpp
myServo.write(servoPos ? 45 : 330);
```

- **서보 각도 범위(0~180) 초과**
- 끝각에서 지속 밀림
- 과전류 발생

### ❌ 원인 2 (환경)

- ESP32 5V 전원 사용
- WiFi + 레이저 + 서보 동시 구동
- 전류 피크 → 서보 드라이버 스트레스

### 🔬 진단 과정

- 단독 서보 테스트 코드 실행
- ❌ 기존 서보: 완전 무반응
- ✅ 예비 서보: 정상 동작

👉 **서보 하드웨어 사망 확정 (드라이버 IC)**

📌 교훈

> “서보는 기어보다 드라이버가 먼저 죽는다.”

---

## 5️⃣ 조치: 코드 전면 수정 (안정화)

### 🔧 바꾼 것

- ❌ 180도 초과 값 제거
- ✅ 안전 각도 범위 사용 (60~120)
- ✅ 부드러운 각도 이동 (1도씩)
- ✅ `detach()`로 OFF 시 전류 차단
- ✅ 레이저 / 서보 로직 완전 분리

👉 **“잘 되다가 갑자기 안 되는” 현상 재발 방지**

---

## 6️⃣ 최종 하드웨어 선택

### ❌ 기존 서보

- SG90 계열 추정
- 플라스틱 기어
- 토크/내구성 부족
- **사망**

### ✅ 새로 구매

🟢 **MG90S**

- 메탈 기어
- 토크 여유
- 같은 크기 / 같은 배선
- 코드 그대로 사용 가능

👉 **지금 프로젝트에 최적 선택**

📌 교훈

> “서보는 싼 걸 여러 번 사느니, 한 단계 위가 낫다.”

---

## 7️⃣ 오늘의 핵심 교훈 요약 🎯

1. **모듈 핀맵은 반드시 실물 기준으로 확인**
2. **ESP32 = 3.3V, 5V 모듈은 항상 전원 경계 의심**
3. **서보 각도 초과는 즉사급 실수**
4. **OFF 시 detach는 생존 스킬**
5. **문제 생기면 단독 테스트가 제일 빠른 진단**
6. **하드웨어 사망은 코드로 고칠 수 없다**

---

## 8️⃣ 지금 상태

- ✅ HTTP 서버 정상
- ✅ 레이저 동작 이해 완료
- ✅ 서보 문제 원인 명확
- ✅ MG90S로 재시작 준비 완료
- 🔜 다음 단계: 안정적인 외부 전원 or 동기 제어
